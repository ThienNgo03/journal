import{f as C,u as z,j as e,B as j,r,i as A,k as V,l as q,P as R,m as F,n as $,h as D,t as I,X}from"./index-Jes1nCj3.js";import{D as K,a as Y,E as J,b as Q,c as Z,d as ee,e as te,f as k,u as P,g as B,R as se,P as ae,r as ne,h as N,i as re,j as ie,k as oe,l as ce,m as le,n as de,B as ue,T as he,o as pe,p as E,q as T}from"./pagination-BIzHvlZv.js";import{u as xe}from"./get-exercise-C1OFjXRA.js";import{B as me}from"./badge-Qfazmm_z.js";import{p as ge}from"./index-otjVXVq-.js";import{u as fe}from"./useMutation-DXhFq-E6.js";import{A as je,a as we,b as ve,c as be,d as Ce,C as Se,e as ke,f as Ne,g as Pe}from"./alert-dialog-DBdeH7jt.js";import{I as y}from"./input-Ch21jCgc.js";import"./getErrorMessage-DVxqjZy-.js";function ye(){const[t]=C(),a=De(t),{data:s,refetch:c,isLoading:n}=xe(a);return{data:s,refetch:c,isLoading:n}}function De(t){const a=t.get("pageIndex"),s=t.get("pageSize");return{pageIndex:a?parseInt(a,10)-1:0,pageSize:s?parseInt(s,10):20,name:t.get("searchTerm")||void 0,description:t.get("searchTerm")||void 0,type:t.get("searchTerm")||void 0}}function Ie({data:t,onClick:a}){const s=z();return e.jsxs(K,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(j,{size:"icon",variant:"ghost",children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsxs(Q,{className:"w-32",align:"start",children:[e.jsx(Z,{className:"font-semibold",children:"Actions"}),e.jsx(ee,{}),e.jsxs(te,{children:[e.jsx(k,{onClick:()=>navigator.clipboard.writeText(t.id),children:"Copy ID"}),e.jsx(k,{onClick:()=>s(`/exercises/${t.id}`),children:"Edit"}),e.jsx(k,{className:"group text-red-400",onClick:a,children:e.jsx("span",{className:"group-hover:text-red-500",children:"Delete"})})]})]})]})}async function Ee({exerciseId:t,isDeleteWorkouts:a=!1}){const s=await ge.delete("/exercises",{params:{id:t,isDeleteWorkouts:a}});if(s.status!==204)throw new Error(`Error deleting exercise: ${s.statusText}`);return s.data}function Te(){return fe({mutationFn:Ee,mutationKey:["delete-exercise"]})}function Me(t){const a=r.useRef({value:t,previous:t});return r.useMemo(()=>(a.current.value!==t&&(a.current.previous=a.current.value,a.current.value=t),a.current.previous),[t])}var S="Switch",[ze]=q(S),[Ae,Re]=ze(S),_=r.forwardRef((t,a)=>{const{__scopeSwitch:s,name:c,checked:n,defaultChecked:x,required:h,disabled:u,value:d="on",onCheckedChange:i,form:o,...p}=t,[l,g]=r.useState(null),f=A(a,b=>g(b)),m=r.useRef(!1),w=l?o||!!l.closest("form"):!0,[v,U]=V({prop:n,defaultProp:x??!1,onChange:i,caller:S});return e.jsxs(Ae,{scope:s,checked:v,disabled:u,children:[e.jsx(R.button,{type:"button",role:"switch","aria-checked":v,"aria-required":h,"data-state":H(v),"data-disabled":u?"":void 0,disabled:u,value:d,...p,ref:f,onClick:F(t.onClick,b=>{U(W=>!W),w&&(m.current=b.isPropagationStopped(),m.current||b.stopPropagation())})}),w&&e.jsx(G,{control:l,bubbles:!m.current,name:c,value:d,checked:v,required:h,disabled:u,form:o,style:{transform:"translateX(-100%)"}})]})});_.displayName=S;var L="SwitchThumb",O=r.forwardRef((t,a)=>{const{__scopeSwitch:s,...c}=t,n=Re(L,s);return e.jsx(R.span,{"data-state":H(n.checked),"data-disabled":n.disabled?"":void 0,...c,ref:a})});O.displayName=L;var Be="SwitchBubbleInput",G=r.forwardRef(({__scopeSwitch:t,control:a,checked:s,bubbles:c=!0,...n},x)=>{const h=r.useRef(null),u=A(h,x),d=Me(s),i=$(a);return r.useEffect(()=>{const o=h.current;if(!o)return;const p=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(p,"checked").set;if(d!==s&&g){const f=new Event("click",{bubbles:c});g.call(o,s),o.dispatchEvent(f)}},[d,s,c]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:u,style:{...n.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});G.displayName=Be;function H(t){return t?"checked":"unchecked"}var _e=_,Le=O;function Oe({className:t,...a}){return e.jsx(_e,{"data-slot":"switch",className:D("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(Le,{"data-slot":"switch-thumb",className:D("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function Ge({open:t,onOpenChange:a,exerciseId:s}){const[c,n]=r.useState(""),[x,h]=r.useState(!1),{mutate:u}=Te();function d(){navigator.clipboard.writeText(s)}function i(p){p||(n(""),h(!1)),a(p)}function o(){u({exerciseId:s,isDeleteWorkouts:x},{onSuccess(){I.success("Exercise deleted successfully",{description:"Exercise deleted successfully"})},onError(p){I.error("Error deleting exercise",{description:p instanceof Error?p.message:"Unknown error"})}})}return e.jsx(je,{open:t,onOpenChange:i,children:e.jsxs(we,{children:[e.jsxs(ve,{children:[e.jsx(be,{children:"Confirm Deletion"}),e.jsx(Ce,{asChild:!0,children:e.jsxs("div",{children:["This action is irreversible.",e.jsx("br",{}),"The entity with ID",e.jsxs("span",{className:"font-bold",children:[" ",s,e.jsx(j,{variant:"ghost",size:"icon",className:"w-6 h-6",onClick:d,children:e.jsx(Se,{className:"h-4 w-4"})})]}),"will be permanently deleted from our servers.",e.jsx("br",{}),e.jsxs("div",{className:"flex items-center my-4 gap-2",children:[e.jsx(Oe,{checked:x,onCheckedChange:h})," Also delete associated workouts"]}),"To proceed, please re-enter the ",e.jsx("span",{className:"font-bold",children:"ID"})," below:",e.jsx("br",{}),e.jsx(y,{value:c,onChange:p=>n(p.target.value)})]})})]}),e.jsxs(ke,{children:[e.jsx(Ne,{children:"No"}),e.jsx(Pe,{disabled:c!==s,onClick:o,children:"Yes"})]})]})},s)}function He({refetch:t}){const a=z(),[s]=C(),{update:c}=P(),n=s.get("searchTerm")||"",[x,h]=r.useState(n),u=i=>{h(i),d(i)},d=r.useMemo(()=>B(i=>{c({searchTerm:i})},700),[c]);return r.useEffect(()=>()=>{d.cancel()},[d]),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"relative w-full max-w-sm",children:[e.jsx(y,{placeholder:"Search exercises...",className:"max-w-sm",value:x,onChange:i=>u(i.target.value)}),x&&e.jsx(j,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6 rounded-full",onClick:()=>u(""),children:e.jsx(X,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",onClick:()=>t(),children:[e.jsx(se,{className:"h-4 w-4"}),"Refresh"]}),e.jsxs(j,{onClick:()=>a("/exercises/create"),children:[e.jsx(ae,{className:"h-4 w-4"}),"Create"]})]})]})}function Ue({totalItems:t}){const[a]=C(),{update:s}=P(),c=parseInt(a.get("pageSize")||"20",10),n=parseInt(a.get("pageIndex")||"1",10),[x,h]=r.useState(c.toString()),u=l=>{h(l),d(l)},d=r.useMemo(()=>B(l=>{s({pageSize:l,pageIndex:"1"})},700),[s]);r.useEffect(()=>()=>{d.cancel()},[d]);const i=r.useMemo(()=>Math.ceil(t/c),[t,c]),o=2,p=r.useMemo(()=>{const l=[],g=Math.max(1,n-o),f=Math.min(i,n+o);g>1&&(l.push(1),g>2&&l.push("…"));for(let m=g;m<=f;m++)l.push(m);return f<i&&(f<i-1&&l.push("…"),l.push(i)),l.map((m,w)=>m==="…"?e.jsx(ne,{},`ellipsis-${w}`):e.jsx(N,{children:e.jsx(re,{className:"cursor-pointer",isActive:n===m,onClick:()=>s({pageIndex:m.toString()}),children:m})},m))},[n,i,o,s]);return e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing page ",n," of ",i," (",t," items)"]}),e.jsx(ie,{className:"flex-0",children:e.jsxs(oe,{children:[e.jsx(N,{children:e.jsx(ce,{className:"cursor-pointer",onClick:()=>s({pageIndex:Math.max(n-1,1).toString()})})}),p,e.jsx(N,{children:e.jsx(le,{className:"cursor-pointer",onClick:()=>s({pageIndex:Math.min(n+1,i).toString()})})})]})}),e.jsxs("div",{className:"flex items-center space-x-2 w-25",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Size:"}),e.jsx(y,{className:"text-right",value:x,onChange:l=>u(l.target.value)})]})]})}const We={whiteSpace:"normal",lineHeight:"1.6",paddingTop:"8px",paddingBottom:"8px",overflow:"hidden !important",display:"-webkit-box !important",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:3},M={pageIndex:1,pageSize:20};function Ve(){const[t]=C(),{update:a}=P(),{data:s,refetch:c,isLoading:n}=ye(),[x,h]=r.useState(!1),[u,d]=r.useState(null),i=r.useMemo(()=>[{field:"id",minWidth:200},{field:"name",width:150,flex:1},{field:"description",width:400,cellStyle:We,flex:2},{field:"type",width:150,cellRenderer:o=>e.jsx(me,{children:o.value})},{field:"createdDate",width:150,valueFormatter:o=>de(o.value,"dd/MM/yyyy")},{colId:"actions",headerName:"Actions",width:100,cellRenderer:Ie,cellRendererParams:o=>({onClick:()=>{h(!0),d(o.data.id)},params:o})}],[]);return r.useEffect(()=>{const o=t.get("pageIndex"),p=t.get("pageSize");a({pageIndex:o??M.pageIndex.toString(),pageSize:p??M.pageSize.toString()})},[]),e.jsxs("div",{children:[e.jsx(He,{refetch:c}),e.jsx("div",{className:"h-[calc(100vh-210px)] my-2",children:e.jsx(ue,{data:s?.items||[],isLoading:n,colDefs:i,rowHeight:82})}),e.jsx(Ue,{totalItems:s?.all||0}),u&&e.jsx(Ge,{open:x,onOpenChange:h,exerciseId:u})]})}function et(){return e.jsx("div",{children:e.jsxs(he,{defaultValue:"data",children:[e.jsxs(pe,{children:[e.jsx(E,{value:"data",children:"Data"}),e.jsx(E,{value:"schema",children:"Schema"})]}),e.jsx(T,{value:"data",children:e.jsx(Ve,{})}),e.jsx(T,{value:"schema",children:"Data Schema"})]})})}export{et as default};
